<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Using Different Layers · ReservoirComputing.jl</title><meta name="title" content="Using Different Layers · ReservoirComputing.jl"/><meta property="og:title" content="Using Different Layers · ReservoirComputing.jl"/><meta property="twitter:title" content="Using Different Layers · ReservoirComputing.jl"/><meta name="description" content="Documentation for ReservoirComputing.jl."/><meta property="og:description" content="Documentation for ReservoirComputing.jl."/><meta property="twitter:description" content="Documentation for ReservoirComputing.jl."/><meta property="og:url" content="https://docs.sciml.ai/ReservoirComputing/stable/esn_tutorials/change_layers/"/><meta property="twitter:url" content="https://docs.sciml.ai/ReservoirComputing/stable/esn_tutorials/change_layers/"/><link rel="canonical" href="https://docs.sciml.ai/ReservoirComputing/stable/esn_tutorials/change_layers/"/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="ReservoirComputing.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">ReservoirComputing.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">ReservoirComputing.jl</a></li><li><span class="tocitem">General Settings</span><ul><li><a class="tocitem" href="../../general/different_training/">Changing Training Algorithms</a></li><li><a class="tocitem" href="../../general/states_variation/">Altering States</a></li><li><a class="tocitem" href="../../general/predictive_generative/">Generative vs Predictive</a></li></ul></li><li><span class="tocitem">Echo State Network Tutorials</span><ul><li><a class="tocitem" href="../lorenz_basic/">Lorenz System Forecasting</a></li><li class="is-active"><a class="tocitem" href>Using Different Layers</a><ul class="internal"><li><a class="tocitem" href="#Example-of-minimally-complex-ESN"><span>Example of minimally complex ESN</span></a></li><li><a class="tocitem" href="#Bibliography"><span>Bibliography</span></a></li></ul></li><li><a class="tocitem" href="../different_drivers/">Using Different Reservoir Drivers</a></li><li><a class="tocitem" href="../deep_esn/">Deep Echo State Networks</a></li><li><a class="tocitem" href="../hybrid/">Hybrid Echo State Networks</a></li></ul></li><li><a class="tocitem" href="../../reca_tutorials/reca/">Reservoir Computing with Cellular Automata</a></li><li><span class="tocitem">API Documentation</span><ul><li><a class="tocitem" href="../../api/training/">Training Algorithms</a></li><li><a class="tocitem" href="../../api/states/">States Modifications</a></li><li><a class="tocitem" href="../../api/predict/">Prediction Types</a></li><li><a class="tocitem" href="../../api/esn/">Echo State Networks</a></li><li><a class="tocitem" href="../../api/inits/">ESN Initializers</a></li><li><a class="tocitem" href="../../api/esn_drivers/">ESN Drivers</a></li><li><a class="tocitem" href="../../api/esn_variations/">ESN Variations</a></li><li><a class="tocitem" href="../../api/reca/">ReCA</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Echo State Network Tutorials</a></li><li class="is-active"><a href>Using Different Layers</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Using Different Layers</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/SciML/ReservoirComputing.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/SciML/ReservoirComputing.jl/blob/master/docs/src/esn_tutorials/change_layers.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Using-different-layers"><a class="docs-heading-anchor" href="#Using-different-layers">Using different layers</a><a id="Using-different-layers-1"></a><a class="docs-heading-anchor-permalink" href="#Using-different-layers" title="Permalink"></a></h1><p>A great deal of efforts in the ESNs field are devoted to finding an ideal construction for the reservoir matrices. ReservoirComputing.jl offers multiple implementation of reservoir and input matrices initializations found in the literature. The API is standardized, and follows by <a href="https://github.com/LuxDL/Lux.jl/tree/main/lib/WeightInitializers">WeightInitializers.jl</a>:</p><pre><code class="language-julia hljs">weights = init(rng, dims...)
#rng is optional
weights = init(dims...)</code></pre><p>Additional keywords can be added when needed:</p><pre><code class="language-julia hljs">weights_init = init(rng; kwargs...)
weights = weights_init(rng, dims...)
# or
weights_init = init(; kwargs...)
weights = weights_init(dims...)</code></pre><p>Custom layers only need to follow these APIs to be compatible with ReservoirComputing.jl.</p><h2 id="Example-of-minimally-complex-ESN"><a class="docs-heading-anchor" href="#Example-of-minimally-complex-ESN">Example of minimally complex ESN</a><a id="Example-of-minimally-complex-ESN-1"></a><a class="docs-heading-anchor-permalink" href="#Example-of-minimally-complex-ESN" title="Permalink"></a></h2><p>Using <sup class="footnote-reference"><a id="citeref-rodan2012" href="#footnote-rodan2012">[rodan2012]</a></sup> and <sup class="footnote-reference"><a id="citeref-rodan2010" href="#footnote-rodan2010">[rodan2010]</a></sup> as references this section will provide an example on how to change both the input layer and the reservoir for ESNs.</p><p>The task for this example will be the one step ahead prediction of the Henon map. To obtain the data one can leverage the package <a href="https://juliadynamics.github.io/PredefinedDynamicalSystems.jl/dev/">PredefinedDynamicalSystems.jl</a>. The data is scaled to be between -1 and 1.</p><pre><code class="language-julia hljs">using PredefinedDynamicalSystems
train_len = 3000
predict_len = 2000

ds = Systems.henon()
traj, t = trajectory(ds, 7000)
data = Matrix(traj)&#39;
data = (data .- 0.5) .* 2
shift = 200

training_input = data[:, shift:(shift + train_len - 1)]
training_target = data[:, (shift + 1):(shift + train_len)]
testing_input = data[:, (shift + train_len):(shift + train_len + predict_len - 1)]
testing_target = data[:, (shift + train_len + 1):(shift + train_len + predict_len)]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2×2000 Matrix{Float64}:
  0.0479479  -0.00671812   0.623758  …  -2.16788    0.70156  -1.37708
 -1.23798    -0.685616    -0.702015     -0.343682  -1.35036  -0.489532</code></pre><p>Now it is possible to define the input layers and reservoirs we want to compare and run the comparison in a simple for loop. The accuracy will be tested using the mean squared deviation msd from StatsBase.</p><pre><code class="language-julia hljs">using ReservoirComputing, StatsBase

res_size = 300
input_layer = [minimal_init(; weight=0.85, sampling_type=:irrational),
    minimal_init(; weight=0.95, sampling_type=:irrational)]
reservoirs = [simple_cycle(; weight=0.7),
    cycle_jumps(; cycle_weight=0.7, jump_weight=0.2, jump_size=5)]

for i in 1:length(reservoirs)
    esn = ESN(training_input, 2, res_size;
        input_layer=input_layer[i],
        reservoir=reservoirs[i])
    wout = train(esn, training_target, StandardRidge(0.001))
    output = esn(Predictive(testing_input), wout)
    println(msd(testing_target, output))
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.00350414394659324
0.003952170426339956</code></pre><p>As it is possible to see, changing layers in ESN models is straightforward. Be sure to check the API documentation for a full list of reservoir and layers.</p><h2 id="Bibliography"><a class="docs-heading-anchor" href="#Bibliography">Bibliography</a><a id="Bibliography-1"></a><a class="docs-heading-anchor-permalink" href="#Bibliography" title="Permalink"></a></h2><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-rodan2012"><a class="tag is-link" href="#citeref-rodan2012">rodan2012</a>Rodan, Ali, and Peter Tiňo. “Simple deterministically constructed cycle reservoirs with regular jumps.” Neural computation 24.7 (2012): 1822-1852.</li><li class="footnote" id="footnote-rodan2010"><a class="tag is-link" href="#citeref-rodan2010">rodan2010</a>Rodan, Ali, and Peter Tiňo. “Minimum complexity echo state network.” IEEE transactions on neural networks 22.1 (2010): 131-144.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lorenz_basic/">« Lorenz System Forecasting</a><a class="docs-footer-nextpage" href="../different_drivers/">Using Different Reservoir Drivers »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Thursday 6 March 2025 16:30">Thursday 6 March 2025</span>. Using Julia version 1.11.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
