steps:
  - label: ":page_facing_up: Build and Deploy Documentation"
    plugins:
      - JuliaCI/julia#v1:
          version: "1"
    command: |
      julia --project=docs -e '
        println("--- :julia: Instantiating project")
        using Pkg
        Pkg.develop(PackageSpec(path=pwd()))
        Pkg.instantiate()
        println("--- :julia: Building documentation")
        include("docs/make.jl")
      '
    agents:
      queue: "juliagpu"
      cuda: "*"
    env:
      DATADEPS_ALWAYS_ACCEPT: true
    if: build.message !~ /\[skip docs\]/ && !build.pull_request.draft
    timeout_in_minutes: 1000

env:
  JULIA_PKG_SERVER: "" # it often struggles with our large artifacts
  SECRET_DOCUMENTER_KEY: "qmrtZ2jy2W0e2h5zu3V7g+wxiz/1BHLsjKGHfosfjxel5nf6/s1mPA+4DEZcBUHwBFt7tfxoKOA6H1gk5PdbyJvFJA6xs4/PT8xvotzv9eYpxtJIoKLRQvjUCq78T+7/0DoicsMNk1uP3/JNkwm4TRLqVXs9QAe9HPnh6x+q/Sro0x9DXIUE2xbTQ3JP6ZUVhS04X7OCeuGTJbW8TdH8B+7V90+gJZcg5a7ctRP/V+PxDo++SOmdyryeqvwE+e6a8+czUWh9gaFQ4dXFRgoUAq+O/jRXSbQfWBXLGaubpMAodgZUmzVSOygELDdRVUhaENgfQfvnUpgpxX8UX/3Bcw==;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"